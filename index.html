<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SpaceX 2026 Launch Tracker</title>
    <!-- Bootstrap CDN for nice styling -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { padding: 20px; background-color: #f8f9fa; }
        .summary-card { text-align: center; padding: 20px; margin-bottom: 20px; }
        .patch-img { width: 60px; height: auto; }
        .achievements { font-size: 0.9em; }
    </style>
</head>
<body>
    <div class="container">
        <h1 class="text-center my-4">SpaceX Launch Tracker – 2026</h1>
        <p class="text-center text-muted" id="last-updated">Loading data...</p>

        <div class="row" id="summary-row">
            <!-- Summary cards will be inserted here by JS -->
        </div>

        <h2 class="mt-5">Completed Successful Launches</h2>
        <div id="launches-table"></div>

        <div id="no-launches" class="alert alert-info mt-4" style="display:none;">
            No successful launches completed yet in 2026.
        </div>

        <footer class="text-center text-muted mt-5">
            Data from RocketLaunch.Live API • Site updates automatically • Only successful completed launches in 2026 are counted • Note: Detailed booster/fairing recovery data not available in this API
        </footer>
    </div>

    <script>
        async function loadLaunches() {
            try {
                const now = new Date();
                const response = await fetch('https://fdo.rocketlaunch.live/json/launches?after_date=2026-01-01&before_date=2026-12-31&provider_id=4&limit=200&direction=asc');

                const data = await response.json();
                const allLaunches = data || [];

                // Filter only completed successful launches
                const completedSuccessful = allLaunches.filter(l => {
                    const launchDate = new Date(l.win_open || l.t0 || l.est_date);
                    return launchDate <= now && l.result === 1;
                });

                document.getElementById('last-updated').textContent = 
                    `Data current as of ${now.toLocaleString()} (refreshes on page load)`;

                // Counts
                const total = completedSuccessful.length;

                const falcon9 = completedSuccessful.filter(l => l.vehicle.name.includes("Falcon 9")).length;
                const falconHeavy = completedSuccessful.filter(l => l.vehicle.name.includes("Heavy")).length;
                const starship = completedSuccessful.filter(l => l.vehicle.name.includes("Starship")).length;

                // Falcon family only for mission types
                const falconLaunches = completedSuccessful.filter(l => 
                    l.vehicle.name.includes("Falcon 9") || l.vehicle.name.includes("Heavy")
                );

                let crew = 0, cargo = 0, rideshare = 0, commercial = 0, privatePayload = 0;
                falconLaunches.forEach(l => {
                    const name = (l.name || "").toLowerCase();
                    if (name.includes("crew-")) crew++;
                    else if (name.includes("crs-")) cargo++;
                    else if (name.includes("transporter") || name.includes("bandwagon")) rideshare++;
                    else if (name.includes("starlink") || name.includes("starshield")) privatePayload++;
                    else commercial++;
                });

                // Insert summary cards
                const summaryRow = document.getElementById('summary-row');
                summaryRow.innerHTML = `
                    <div class="col-md-3"><div class="card summary-card bg-primary text-white"><h3>${total}</h3><p>Total Successful Launches</p></div></div>
                    <div class="col-md-3"><div class="card summary-card bg-info text-white"><h3>${falcon9}</h3><p>Falcon 9</p></div></div>
                    <div class="col-md-3"><div class="card summary-card bg-info text-white"><h3>${falconHeavy}</h3><p>Falcon Heavy</p></div></div>
                    <div class="col-md-3"><div class="card summary-card bg-dark text-white"><h3>${starship}</h3><p>Starship</p></div></div>
                    <div class="col-md-2"><div class="card summary-card bg-success text-white"><h4>${crew}</h4><p>ISS Crew</p></div></div>
                    <div class="col-md-2"><div class="card summary-card bg-success text-white"><h4>${cargo}</h4><p>ISS Cargo</p></div></div>
                    <div class="col-md-2"><div class="card summary-card bg-warning text-dark"><h4>${rideshare}</h4><p>Rideshare</p></div></div>
                    <div class="col-md-3"><div class="card summary-card bg-secondary text-white"><h4>${commercial}</h4><p>Commercial Customer</p></div></div>
                    <div class="col-md-3"><div class="card summary-card bg-secondary text-white"><h4>${privatePayload}</h4><p>Private Payload (Starlink)</p></div></div>
                `;

                // Build table
                const tableDiv = document.getElementById('launches-table');
                if (completedSuccessful.length === 0) {
                    document.getElementById('no-launches').style.display = 'block';
                    tableDiv.innerHTML = '';
                    return;
                }

                let tableHTML = `
                    <table class="table table-striped table-hover mt-3">
                        <thead class="table-dark">
                            <tr>
                                <th>Patch</th>
                                <th>Date (UTC)</th>
                                <th>Flight #</th>
                                <th>Rocket</th>
                                <th>Mission</th>
                                <th>Type</th>
                                <th>Objectives / Achievements</th>
                                <th>Links</th>
                            </tr>
                        </thead>
                        <tbody>
                `;

                completedSuccessful.forEach(launch => {
                    const date = new Date(launch.win_open || launch.t0 || launch.est_date).toLocaleString();
                    const rocket = launch.vehicle.name;
                    const missionName = launch.name;
                    const patch = ''; // No patch in this API

                    // Determine type (same logic as counts)
                    let type = "Unknown";
                    if (rocket.includes("Starship")) type = "Starship Flight";
                    else {
                        const nameLower = missionName.toLowerCase();
                        if (nameLower.includes("crew-")) type = "ISS Crew Mission";
                        else if (nameLower.includes("crs-")) type = "ISS Cargo Resupply";
                        else if (nameLower.includes("transporter") || nameLower.includes("bandwagon")) type = "Rideshare";
                        else if (nameLower.includes("starlink") || nameLower.includes("starshield")) type = "Private Payload (Starlink)";
                        else type = "Commercial Customer Payload";
                    }

                    // Achievements / objectives
                    let achievements = [];
                    achievements.push(`<strong>Overall:</strong> Mission success`);
                    if (launch.launch_description) {
                        achievements.push(`<em>${launch.launch_description}</em>`);
                    }

                    // Links
                    let links = [];
                    if (launch.slug) links.push(`<a href="https://www.rocketlaunch.live/launch/${launch.slug}" target="_blank">Details</a>`);

                    tableHTML += `
                        <tr>
                            <td>${patch ? `<img src="${patch}" class="patch-img" alt="Patch">` : ''}</td>
                            <td>${date}</td>
                            <td>${launch.id || '-'}</td>
                            <td>${rocket}</td>
                            <td>${missionName}</td>
                            <td>${type}</td>
                            <td class="achievements"><ul class="list-unstyled mb-0">${achievements.map(a => `<li>${a}</li>`).join('')}</ul></td>
                            <td>${links.join(' | ')}</td>
                        </tr>
                    `;
                });

                tableHTML += `</tbody></table>`;
                tableDiv.innerHTML = tableHTML;

            } catch (err) {
                document.getElementById('last-updated').textContent = 'Error loading data – try refreshing';
                console.error(err);
            }
        }

        loadLaunches();
    </script>
</body>
</html>
