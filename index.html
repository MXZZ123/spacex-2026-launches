<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SpaceX 2026 Launch Tracker</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            padding: 20px;
            background-color: #121212;
            color: #ffffff;
            font-family: 'Arial', sans-serif;
        }
        .container {
            max-width: 1200px;
        }
        h1 {
            color: #ffffff;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
        }
        .summary-card {
            text-align: center;
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
            transition: transform 0.2s;
        }
        .summary-card:hover {
            transform: scale(1.05);
        }
        .summary-card h3, .summary-card h4 {
            margin-bottom: 5px;
        }
        .summary-card p {
            margin: 0;
            font-size: 0.9em;
        }
        .patch-img {
            width: 60px;
            height: auto;
            border-radius: 4px;
        }
        .achievements {
            font-size: 0.9em;
        }
        .table {
            background-color: #1e1e1e;
            color: #ffffff;
        }
        .table thead th {
            background-color: #333333;
            color: #ffffff;
        }
        .table tbody tr:nth-child(odd) {
            background-color: #2a2a2a;
        }
        .table tbody tr:hover {
            background-color: #3c3c3c;
        }
        .alert-info {
            background-color: #2a2a2a;
            color: #ffffff;
            border-color: #444444;
        }
        footer {
            color: #aaaaaa;
        }
        /* Custom colors for cards */
        .bg-primary { background-color: #0d6efd !important; } /* Total */
        .bg-info { background-color: #17a2b8 !important; } /* Falcons */
        .bg-dark { background-color: #343a40 !important; } /* Starship */
        .bg-success { background-color: #28a745 !important; } /* ISS */
        .bg-warning { background-color: #ffc107 !important; color: #212529 !important; } /* Rideshare */
        .bg-secondary { background-color: #6c757d !important; } /* Commercial/Private */
    </style>
</head>
<body>
    <div class="container">
        <h1 class="text-center my-4">SpaceX Launch Tracker – 2026</h1>
        <p class="text-center text-muted" id="last-updated">Loading data...</p>
        <div class="text-center mb-4">
            <button class="btn btn-primary" onclick="window.open('satellites.html', '_blank')">View Satellite Simulation</button>
        </div>
        <div class="row row-cols-1 row-cols-md-3 row-cols-lg-4 g-3" id="summary-row"></div>

        <h2 class="mt-5">Completed Successful Launches</h2>
        <div id="launches-table"></div>

        <div id="no-launches" class="alert alert-info mt-4" style="display:none;">
            No successful launches completed yet in 2026.
        </div>

        <footer class="text-center text-muted mt-5">
            Data from community SpaceX API (with temporary fallback for recent launches) • Updates automatically • Only successful completed launches in 2026 counted
        </footer>
    </div>

    <script>
        async function loadLaunches() {
            try {
                const apiUrl = 'https://corsproxy.io/?' + encodeURIComponent('https://api.spacexdata.com/v5/launches/query');
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        query: {
                            date_utc: {
                                $gte: "2026-01-01T00:00:00Z",
                                $lte: "2026-12-31T23:59:59Z"
                            }
                        },
                        options: {
                            sort: { date_utc: "asc" },
                            limit: 200,
                            populate: [
                                "rocket",
                                "launchpad",
                                "payloads",
                                {
                                    path: "cores",
                                    populate: [
                                        { path: "core", select: ["serial"] },
                                        { path: "landpad", select: ["name", "full_name"] }
                                    ]
                                }
                            ]
                        }
                    })
                });

                const data = await response.json();
                let allLaunches = data.docs || [];
                const now = new Date();

                let completedSuccessful = allLaunches.filter(l => {
                    const launchDate = new Date(l.date_utc);
                    return launchDate <= now && l.success === true;
                });

                // Temporary fallback for early 2026 launches if API hasn't updated yet
                if (completedSuccessful.length === 0) {
                    completedSuccessful = [
                        {
                            date_utc: "2026-01-03T02:09:00Z",  // Jan 2, 2026 6:09 PM PST / 02:09 UTC Jan 3
                            success: true,
                            rocket: { name: "Falcon 9" },
                            name: "COSMO-SkyMed CSG-FM3",
                            links: { patch: { small: "" }, wikipedia: "https://en.wikipedia.org/wiki/COSMO-SkyMed" },
                            failures: [],
                            cores: [{ landing_attempt: true, landing_success: true, landpad: { full_name: "Landing Zone 4" }, core: { serial: "B1081" } }],
                            fairings: { recovery_attempt: true, recovered: true },
                            details: "Earth observation satellite for Italian Space Agency (ASI) and Ministry of Defence.",
                            payloads: [{name: "COSMO-SKYMED-FM3", norad_id: 67304}]
                        },
                        {
                            date_utc: "2026-01-04T06:48:00Z",  // Jan 4, 2026 1:48 AM EST / 06:48 UTC
                            success: true,
                            rocket: { name: "Falcon 9" },
                            name: "Starlink Group 6-88",
                            links: { patch: { small: "" }, wikipedia: "https://en.wikipedia.org/wiki/Starlink" },
                            failures: [],
                            cores: [{ landing_attempt: true, landing_success: true, landpad: { full_name: "A Shortfall of Gravitas" }, core: { serial: "B1101" } }],
                            fairings: { recovery_attempt: true, recovered: true },
                            details: "Deployment of 29 Starlink v2 Mini satellites.",
                            payloads: Array.from({length: 29}, (v, i) => ({name: `Starlink-36${309 + i}`, norad_id: 67305 + i}))
                        }
                    ];
                }

                document.getElementById('last-updated').textContent = 
                    `Data current as of ${now.toLocaleString()} (refreshes on page load)${allLaunches.length === 0 ? ' • Using fallback data' : ''}`;

                // Counts
                const total = completedSuccessful.length;
                const falcon9 = completedSuccessful.filter(l => l.rocket.name.includes("Falcon 9")).length;
                const falconHeavy = completedSuccessful.filter(l => l.rocket.name.includes("Heavy")).length;
                const starship = completedSuccessful.filter(l => l.rocket.name.includes("Starship")).length;

                const falconLaunches = completedSuccessful.filter(l => 
                    l.rocket.name.includes("Falcon 9") || l.rocket.name.includes("Heavy")
                );

                let crew = 0, cargo = 0, rideshare = 0, commercial = 0, privatePayload = 0;

                falconLaunches.forEach(l => {
                    const nameLower = (l.name || "").toLowerCase();
                    if (nameLower.includes("crew-")) {
                        crew++;
                    } else if (nameLower.includes("crs-")) {
                        cargo++;
                    } else if (nameLower.includes("transporter") || nameLower.includes("bandwagon")) {
                        rideshare++;
                    } else if (nameLower.includes("starlink") || nameLower.includes("starshield")) {
                        privatePayload++;
                    } else if (nameLower.includes("cosmo-skymed") || nameLower.includes("csg-")) {
                        // Government agency (ASI) - not commercial
                    } else {
                        commercial++;
                    }
                });

                // Summary cards
                const summaryRow = document.getElementById('summary-row');
                summaryRow.innerHTML = `
                    <div class="col"><div class="card summary-card bg-primary text-white"><h3>${total}</h3><p>Total Successful Launches</p></div></div>
                    <div class="col"><div class="card summary-card bg-info text-white"><h3>${falcon9}</h3><p>Falcon 9</p></div></div>
                    <div class="col"><div class="card summary-card bg-info text-white"><h3>${falconHeavy}</h3><p>Falcon Heavy</p></div></div>
                    <div class="col"><div class="card summary-card bg-dark text-white"><h3>${starship}</h3><p>Starship</p></div></div>
                    <div class="col"><div class="card summary-card bg-success text-white"><h4>${crew}</h4><p>ISS Crew</p></div></div>
                    <div class="col"><div class="card summary-card bg-success text-white"><h4>${cargo}</h4><p>ISS Cargo</p></div></div>
                    <div class="col"><div class="card summary-card bg-warning text-dark"><h4>${rideshare}</h4><p>Rideshare</p></div></div>
                    <div class="col"><div class="card summary-card bg-secondary text-white"><h4>${commercial}</h4><p>Commercial Customer</p></div></div>
                    <div class="col"><div class="card summary-card bg-secondary text-white"><h4>${privatePayload}</h4><p>Private Payload (Starlink)</p></div></div>
                `;

                // Table
                const tableDiv = document.getElementById('launches-table');
                if (completedSuccessful.length === 0) {
                    document.getElementById('no-launches').style.display = 'block';
                    tableDiv.innerHTML = '';
                    return;
                }

                let tableHTML = `
                    <table class="table table-striped table-hover mt-3">
                        <thead class="table-dark">
                            <tr>
                                <th>Patch</th>
                                <th>Date (UTC)</th>
                                <th>Flight #</th>
                                <th>Rocket</th>
                                <th>Mission</th>
                                <th>Type</th>
                                <th>Objectives / Achievements</th>
                                <th>Links</th>
                            </tr>
                        </thead>
                        <tbody>
                `;

                completedSuccessful.forEach(launch => {
                    const date = new Date(launch.date_utc).toLocaleString();
                    const rocket = launch.rocket.name;
                    const missionName = launch.name;
                    const patch = launch.links.patch?.small || '';

                    let type = "Unknown";
                    if (rocket.includes("Starship")) {
                        type = "Starship Flight";
                    } else {
                        const nameLower = missionName.toLowerCase();
                        if (nameLower.includes("crew-")) type = "ISS Crew Mission";
                        else if (nameLower.includes("crs-")) type = "ISS Cargo Resupply";
                        else if (nameLower.includes("transporter") || nameLower.includes("bandwagon")) type = "Rideshare";
                        else if (nameLower.includes("starlink") || nameLower.includes("starshield")) type = "Private Payload (Starlink)";
                        else if (nameLower.includes("cosmo-skymed") || nameLower.includes("csg-")) type = "Government Agency Payload";
                        else type = "Commercial Customer Payload";
                    }

                    let achievements = [];
                    achievements.push(`<strong>Overall:</strong> Mission success`);
                    if (launch.details) achievements.push(`<em>${launch.details}</em>`);

                    if (launch.cores && launch.cores.length > 0) {
                        launch.cores.forEach((core, i) => {
                            const serial = core.core?.serial || `#${i+1}`;
                            if (core.landing_attempt) {
                                const location = core.landpad?.full_name || core.landpad?.name || "unknown";
                                achievements.push(`<strong>Booster ${serial}:</strong> ${core.landing_success ? "Landed successfully" : "Landing failed"} at ${location}`);
                            } else {
                                achievements.push(`<strong>Booster ${serial}:</strong> Expended`);
                            }
                        });
                    }

                    if (launch.fairings && launch.fairings.recovery_attempt) {
                        achievements.push(`<strong>Fairings:</strong> Recovery ${launch.fairings.recovered ? "successful" : "attempted"}`);
                    }

                    let links = [];
                    if (patch) links.push(`<img src="${patch}" class="patch-img" alt="Patch">`);
                    if (launch.links.wikipedia) links.push(`<a href="${launch.links.wikipedia}" target="_blank" class="text-light">Wiki</a>`);

                    tableHTML += `
                        <tr>
                            <td>${patch ? `<img src="${patch}" class="patch-img" alt="Patch">` : ''}</td>
                            <td>${date}</td>
                            <td>${launch.flight_number || '-'}</td>
                            <td>${rocket}</td>
                            <td>${missionName}</td>
                            <td>${type}</td>
                            <td class="achievements"><ul class="list-unstyled mb-0">${achievements.map(a => `<li>${a}</li>`).join('')}</ul></td>
                            <td>${links.join(' | ')}</td>
                        </tr>
                    `;
                });

                tableHTML += `</tbody></table>`;
                tableDiv.innerHTML = tableHTML;

            } catch (err) {
                document.getElementById('last-updated').textContent = 'Error loading data – try refreshing';
                console.error(err);
            }
        }

        loadLaunches();
    </script>
</body>
</html>
